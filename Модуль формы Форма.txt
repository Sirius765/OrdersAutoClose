
Процедура кнЗаполнитьТаблицуЗаказовНажатие(Элемент)
	
	сПараметры = Новый Структура;
	сПараметры.Вставить("ДатаНачала",Дата(2017,1,1));
	сПараметры.Вставить("ТекущаяДата",ТекущаяДата());
	сПараметры.Вставить("КоличествоДнейОжидания",пвКоличествоДнейОжидания);
	сПараметры.Вставить("Склад",пвСклад);
	сПараметры.Вставить("ОсновнойМенеджерПокупателя_Разное",Справочники.Пользователи.НайтиПоКоду("Разное"));
	тпЗаказы = ЭтотОбъект.ЗаполнитьТаблицуЗаказов(сПараметры);
	ЭлементыФормы.тпЗаказы.СоздатьКолонки();
	//Для Каждого текКол Из ЭлементыФормы.тпЗаказы.Колонки Цикл
	//	текКол.Ширина = 30;
	//КонецЦикла;
КонецПроцедуры

Процедура ПриОткрытии()
	пвКоличествоДнейОжидания = 60;
	пвСклад = Справочники.Склады.НайтиПоКоду("00001");
КонецПроцедуры

Процедура кнПредупредитьНажатие(Элемент)
	Если Вопрос("Предупредить пользователей по отмеченным строкам?",РежимДиалогаВопрос.ДаНет) = КодВозвратаДиалога.Да Тогда
		колСтрок = ПредупредитьПользователей(тпЗаказы);
		Предупреждение("Задачи пользователям обновлены, число строк : "+СокрЛП(колСтрок));
	КонецЕсли;
КонецПроцедуры

Процедура кнЗакрытьИУведомитьНажатие(Элемент)
	Если Вопрос("Закрыть заказы и информировать пользователей по отмеченным строкам?",РежимДиалогаВопрос.ДаНет) = КодВозвратаДиалога.Да Тогда
		колСтрок = ЗакрытьИУведомить(тпЗаказы);
		Предупреждение("Задачи закрыты, уведомления отправлены, число строк : "+СокрЛП(колСтрок));
	КонецЕсли;
КонецПроцедуры

Процедура кнОтметитьВсеНажатие(Элемент)
	тпЗаказы.ЗаполнитьЗначения(Истина,"Обработать");
КонецПроцедуры

Процедура кнРазотметитьВсеНажатие(Элемент)
	тпЗаказы.ЗаполнитьЗначения(Ложь,"Обработать");
КонецПроцедуры

Процедура КнопкаВыполнитьВсеНажатие(Элемент)
	сПараметры = Новый Структура;
	сПараметры.Вставить("ДатаНачала",Дата(2017,1,1));
	сПараметры.Вставить("ТекущаяДата",ТекущаяДата());
	сПараметры.Вставить("КоличествоДнейОжидания",Справочники.дм_КонстантыМегатрейд.КоличествоДнейОжиданияАвтозакрытияЗаказовПокупателей.Значение);
	тпЗаказы = ЗаполнитьТаблицуЗаказов(сПараметры);
	тпЗаказы.ЗаполнитьЗначения(Истина,"Обработать");
	//предупреждаем по тем, по которым следует предупредить
	//ПредупредитьПользователей(тпЗаказы);
	//закрываем по тем, которые надо закрыть
	ЗакрытьИУведомить(тпЗаказы);
	
	//ЗаписатьВЛогФайл("Закрытие заказов поставщиков");
	// ++МС 08.10.2017 МТ0039 Автозакрытие заказов поставщиков
	сПараметры = Новый Структура;
	сПараметры.Вставить("ДатаНачала",Дата(2013,1,1));
	сПараметры.Вставить("ТекущаяДата",ТекущаяДата());
	сПараметры.Вставить("КоличествоДнейОжидания",Справочники.дм_КонстантыМегатрейд.КоличествоДнейОжиданияАвтозакрытияЗаказовПоставщикам.Значение);
	//ЗаписатьВЛогФайл("Создать закрытие заказов поставщиков");
	ЗакрытьЗаказыПоставщикам(сПараметры);
		

КонецПроцедуры
